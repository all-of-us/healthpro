{% extends 'base.html.twig' %}
{% block title %}Problems - {% endblock %}
{% block body %}
    <div class="row" id="problemForm">
        <div class="col-sm-12">
            <div class="page-header">
                <h2>
                    <i class="fa fa-clipboard" aria-hidden="true"></i>
                    {% if problem %}
                        {{ problem.created_ts|date('n/j/Y', app.userTimezone) }}
                    {% else %}
                        New Report
                    {% endif %}
                    <small><a href="{{ path('participant', { id: participant.id }) }}">{{ participant.lastName }}, {{ participant.firstName }}</a></small>
                </h2>
            </div>
            {{ form_start(problemForm, { attr: { class: 'warn-unsaved' } }) }}
            {{ form_errors(problemForm) }}
            {{ form_rest(problemForm) }}
            {% if problemCommentForm is null %}
                <p>
                    <a href="{{ path('participant', { id: participant.id }) }}" class="btn btn-default">Cancel</a>
                    <button type="submit" name="reportable" class="btn btn-primary">Save</button>
                    <button type="submit" name="reportable_finalize" class="btn btn-success pull-right" onclick="return confirm('Are you sure you want to finalize this report?');">Save and Finalize</button>
                </p>
            {% endif %}       
            {{ form_end(problemForm) }}
            {% if problemCommentForm %}
                <h4>Add Comments</h4> 
                {{ form_start(problemCommentForm, { attr: { class: 'warn-unsaved', action: path('problemComment', { participantId: participant.id, problemId: problem.id }) } }) }}
                {{ form_errors(problemCommentForm) }}
                {{ form_rest(problemCommentForm) }}
                <p>
                    <a href="{{ path('participant', { id: participant.id }) }}" class="btn btn-default">Cancel</a>
                    <button type="submit" name="reportable" class="btn btn-primary">Save</button>
                </p>
                {{ form_end(problemCommentForm) }}
            {% endif %}    
        </div>
    </div>
{% endblock %}

{% block pagejs %}
<script>

$(document).ready(function() {
    $('#form_problem_date').pmiDateTimePicker();
    $('#form_provider_aware_date').pmiDateTimePicker();
});

</script>
{% endblock %}
