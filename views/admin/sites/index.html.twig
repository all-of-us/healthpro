{% extends 'base.html.twig' %}
{% block title %}Sites - {% endblock %}
{% block bodycontainer %}container-fluid{% endblock %}
{% block body %}
    <div class="page-header">
        <h2><i class="fa fa-hospital-o" aria-hidden="true"></i> Site Management</h2>
    </div>
    <p>
        {% if sync %}
            <a href="{{ path('admin_siteSync') }}" class="btn btn-primary"><i class="fa fa-refresh" aria-hidden="true"></i> Sync Sites</a>
        {% else %}
            <a href="{{ path('admin_site') }}" class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i> Add Site</a> <a href="{{ path('admin_siteSync') }}" class="btn btn-default"><i class="fa fa-refresh" aria-hidden="true"></i> Preview Site Sync</a>
        {% endif %}
    </p>
    {% if sites|length > 0 %}
        <table class="table table-striped table-hover">
            <thead><tr><th>ID</th><th>Name</th><th>Google Group</th><th>Awardee</th><th>Organization</th><th>MayoLink Account</th><th>Type</th><th>Email</th></tr></thead>
            <tbody>
            {% for site in sites %}
                <tr>
                    <td>{{ site.id }}</td>
                    <td><a href="{{ path('admin_site', { siteId: site.id }) }}">{{ site.name }}</a></td>
                    <td>{{ site.google_group }}</td>
                    <td>{{ site.organization }}</td>
                    <td>{{ site.organization_id }}</td>
                    <td>{{ site.mayolink_account }}</td>
                    <td>{{ site.type }}</td>
                    <td>{{ site.email|length > 30 ? site.email|slice(0, 30) ~ '...' : site.email  }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% endif %}
{% endblock %}

{% block pagejs %}
<script>
$(document).ready(function() {
    var table = $('table').DataTable({
        order: [[1, 'asc']],
        pageLength: 25
    });
});
</script>
{% endblock %}
