{% extends 'base.html.twig' %}
{% block title %}Biobank {{ participant.biobankId }} - {% endblock %}
{% block body %}
    <div class="page-header">
        <h2><i class="fa fa-medkit" aria-hidden="true"></i> Order Details</h2>
    </div>
    <div class="row">
        <div class="col-sm-4">
            <dl class="dl-horizontal">
                {% if is_granted('ROLE_SCRIPPS') or is_granted('ROLE_AWARDEE') %}
                    <dt>Participant ID</dt>
                    <dd>{{ participant.id }}</dd>
                {% endif %}
                <dt>Biobank ID</dt>
                <dd>
                    {% if is_granted('ROLE_SCRIPPS') or is_granted('ROLE_BIOBANK') %}
                        <a href="{{ path('biobank_participant', { biobankId: participant.biobankId }) }}">{{ participant.biobankId }}</a>
                    {% else %}
                        {{ participant.biobankId }}
                    {% endif %}
                </dd>
                <dt>Paired Awardee</dt>
                <dd>{{ participant.awardee ? app.getAwardeeDisplayName(participant.awardee) : '(not paired)' }}</dd>
                <dt>Paired Site</dt>
                <dd>{{ participant.site ? app.getSiteDisplayName(participant.siteSuffix) : '(not paired)' }}</dd>
            </dl>
        </div>
        <div class="col-sm-4">
            <p class="lead">
                Order ID: <strong>{{ order.order_id }}</strong>
            </p>
            <h3>
                <i class="fa fa-medkit" aria-hidden="true"></i>
                {{ order.created_ts|date('n/j/Y', app.userTimezone) }}
            </h3>
        </div>
    </div>

    <div role="tabpanel">
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation">
                <a href="#collect" aria-controls="collect" role="tab" data-toggle="tab">
                    {% if order.collected_ts is not empty %}
                        <i class="fa fa-check-circle text-success" aria-hidden="true"></i>
                    {% endif %}
                    Collect
                </a>
            </li>
            <li role="presentation">
                <a href="#process" aria-controls="collect" role="tab" data-toggle="tab">
                    {% if order.processed_ts is not empty %}
                        <i class="fa fa-check-circle text-success" aria-hidden="true"></i>
                    {% endif %}
                    Process
                </a>
            </li>
            <li role="presentation">
                <a href="#finalize" aria-controls="collect" role="tab" data-toggle="tab">
                    {% if order.finalized_ts is not empty %}
                        <i class="fa fa-check-circle text-success" aria-hidden="true"></i>
                    {% endif %}
                    Finalize
                </a>
            </li>
        </ul>
        <br />
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane" id="collect">
                {% include 'partials/biobank-order-details.html.twig' with { type: 'collected' } %}
            </div>
            <div role="tabpanel" class="tab-pane" id="process">
                {% include 'partials/biobank-order-details.html.twig' with { type: 'processed' } %}
            </div>
            <div role="tabpanel" class="tab-pane" id="finalize">
                {% include 'partials/biobank-order-details.html.twig' with { type: 'finalized' } %}
                <div class="row">
                    <div class="col-sm-12">
                        <h3><i class="fa fa-truck" aria-hidden="true"></i> FedEx Tracking Number</h3>
                        {{ order.fedex_tracking|default('Not provided.') }}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block pagejs %}
    <script>
        $(document).ready(function() {
            // Switch tab to active step
            $(".nav-tabs a[href='#{{ currentStep }}']").tab('show');
        });
    </script>
{% endblock %}
