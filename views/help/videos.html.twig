{% extends 'base.html.twig' %}
{% block title %}Videos - {% endblock %}
{% block body %}
    <ol class="breadcrumb">
        <li><a href="{{ path('home') }}">Home</a></li>
        <li><a href="{{ path('help_home') }}">Help</a></li>
        <li class="active">Training Videos</li>
    </ol>
    <div class="page-header">
        <h2><i class="fa fa-film" aria-hidden="true"></i> Training Videos</h2>
    </div>

    <div class="row">
        <div class="col-sm-12">
            <div class="text-right">
                {% if type == 'file' %}
                    <a href="{{ path('help_videos', { type: 'yt' }) }}"> Back to original</a>
                {% else %}
                    Problem loading videos? <a href="{{ path('help_videos', { type: 'file' }) }}"> Click Here</a>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-8 col-sm-push-4">
            <div class="panel panel-default" id="video-panel">
                <div class="panel-heading">
                    <h3 class="panel-title" id="video-title"></h3>
                </div>
                <div class="panel-body">
                    <div class="embed-responsive embed-responsive-16by9">
                        {% if type == 'file' %}
                            <video id="video-file" controls>
                                <source src="" type="video/mp4">
                                Your browser does not support the video tag, consider upgrading to a web browser that supports HTML5 video tag.
                            </video>
                        {% else %}
                            <iframe id="video-embed" class="embed-responsive-item" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-4 col-sm-pull-8 help-videos-nav">
            {% for group in videoGroups %}
                <h4>{{ group.title }}</h4>
                <div class="list-group">
                    {% for video in group.videos %}
                        {% if video.youtube_id %}
                            <a href="#" class="list-group-item load-video" data-embed-src="{{ video.youtube_id }}" data-file-src="{{ video.filename }}">{{ video.title }}</a>
                        {% else %}
                            <div class="list-group-item disabled">{{ video.title }} <em><small>(Coming Soon!)</small></em></div>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
    </div>
    {% include 'help/footer.html.twig' %}
{% endblock %}

{% block pagejs %}
<script>
$(document).ready(function() {
    var type = {{ type|json_encode|raw }};
    var youTubePath = "https://www.youtube.com/embed";
    var helpVideosPath = {{ helpVideosPath|json_encode|raw }};
    var loadVideo = function (src) {
        $('#video-title').html(src.html());
        if (type === 'file') {
            $('#video-file source').attr('src', helpVideosPath + '/' + src.data('file-src'));
            $("#video-file")[0].load();
        } else {
            $('iframe#video-embed').attr('src', youTubePath + '/' + src.data('embed-src') + '?modestbranding=1&rel=0');
        }
        $('a.load-video').removeClass('active');
        src.addClass('active');
    };
    $('a.load-video').on('click', function () {
        loadVideo($(this));
        $('html').scrollTop($('#video-panel').offset().top);
        return false;
    });
    loadVideo($('a.load-video:first'));
});
</script>
{% endblock %}
