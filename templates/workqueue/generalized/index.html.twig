{% set bootstrapVersion = 5 %}
{% extends 'base.html.twig' %}

{% block body %}
<div id="workqueueTable-wrapper" class="workqueueTable-wrapper col-md-12">
    <div class="row mb-3">
        <div class="col-md-12">
            <div class="row">
                {% for columnGroup, number in filteredColumnGroups %}
                    {% if number > 0 %}
                        <div class="col-md-2">
                            <div class="btn-group">
                                <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                    {{ columnGroup }}
                                </button>
                                <ul class="dropdown-menu">
                                    {% for column in columns %}
                                        {% if column.getColumnGroup == columnGroup %}
                                            {% if column.isFilterable %}
                                                <li><a class="dropdown-item filter-show" href="#" data-column="{{ column.getDatafield }}" data-columngroup="{{ columnGroup|replace({" ": "_"})|lower }}">{{ column.getColumnDisplayName }}</a></li>
                                            {% endif %}
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
                {% for columnGroup, number in filteredColumnGroups %}
                    {% if number > 0 %}
                        <div class="col-md-12 d-none" id="filter-group-{{ columnGroup|replace({" ": "_"})|lower }}">
                            <p class="me-4">{{ columnGroup }}</p>
                            <div class="row">
                                {% for column in columns %}
                                    {% if column.getColumnGroup == columnGroup and column.isFilterable %}
                                        {% include 'workqueue/partials/program/NPH/columnFilters/'~ column.getColumnFilterType ~'.html.twig' %}
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        <div class="col-md-12 d-none" id="applied-filters">
            <div class="col-md-12">
                <p class="me-4">Applied Filters:</p>
            </div>
            <div class="row" id="applied-filters-area">

            </div>
        </div>
    </div>
    <div class="col-md-12 mb-3" id="workqueueColvisContainer"></div>
    <div class="col-md-12" id="workqueueTableContainer">
        <table id="workqueueTable" class="table responsive table-striped" style="width: 100%"
               data-colvis-groups="{{ columnGroups|keys|json_encode }}" data-sortable-columns="{{ sortableColumns|json_encode }}"
               data-column-names="{{ fieldNames|json_encode }}">
            <thead>
            {% if columnGroups is not empty %}
                <tr>
                    {% for columnGroup, count in columnGroups %}
                        <th colspan="{{ count }}" class="{{ columnGroup|replace({' ': '_'})|lower }}">{{ columnGroup }}</th>
                    {% endfor %}
                </tr>
            {% endif %}
            <tr>
                {% for column in columns %}
                    <th class="{{ column.getColumnGroup|replace({' ': '_'})|lower }}
                                {% if column.isIncludeInAllGroups %} show_always {% endif %} {% if column.isInDefaultGroup %} default_group {% endif %}">{{ column.getColumnDisplayName }}</th>
                {% endfor %}
            </tr>
            </thead>
        </table>
    </div>
</div>
{% endblock %}

{% block pagejs %}
    {{ encore_entry_script_tags('workqueueGeneralized') }}
{% endblock %}
