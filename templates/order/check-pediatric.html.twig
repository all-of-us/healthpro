{% extends 'base.html.twig' %}
{% block title %}Order - {% endblock %}
{% block body %}
    <div class="page-header">
        <h2>
            <i class="fa fa-medkit" aria-hidden="true"></i>
            New Biobank order
            <small><a href="{{ path('participant', { id: participant.id }) }}">{{ participant.lastName }}, {{ participant.firstName }}</a></small>
        </h2>
    </div>

    {% include 'partials/participant-dl.html.twig' %}

    <ul class="nav nav-tabs">
        <li role="presentation" class="active"><a href="#">Safety Check</a></li>
        {% if siteType == 'dv' %}
            {% set steps = ['Create', 'Collect', 'Process', 'Finalize'] %}
        {% else %}
            {% set steps = ['Create', 'Print Labels', 'Collect', 'Process', 'Finalize', 'Print Requisition'] %}
        {% endif %}
        {% for step in steps %}
            <li role="presentation" class="disabled"><a href="#">{{ step }}</a></li>
        {% endfor %}
    </ul>
    <br/>

    <h3>Has your child had a blood transfusion in the past 6 months?</h3>
    <!--TODO: change form endpoint to pediatric order creation-->
    <form method="post" action="{# TODO: Pediatric order create link #}" id="safety-checks" class="prevent-resubmit">
        <div class="radio">
            <label><input type="radio" name="donate" value="yes" data-show-target="#transfusion-qn" data-hide-target="#bd-qn"/> Yes</label>
        </div>
        <div class="radio">
            <label><input type="radio" name="donate" value="no" data-hide-target="#transfusion-qn" data-show-target="#bd-qn"/> No</label>
        </div>
        <div id="transfusion">
            <div id="transfusion-qn" style="display: none">
                <h3>Please select the specific type of blood transfusion:</h3>
                <div class="checkbox">
                    <label><input type="checkbox" name="transfusion_wb" value="whole" data-vis-toggle="#order-info-text" data-warning-text="#info-text-1,#continue"/> Whole blood transfusion</label>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" name="transfusion_rbc" value="red" data-vis-toggle="#rbc-qn"/> Red Blood Cells (RBC)</label>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" name="transfusion_ppc" value="red"/> Plasma, Platelet, or Cryoprecipitate transfusion</label>
                </div>
            </div>
            <div id="rbc-qn" style="display: none">
                <h3>Has it been at least 2 months since participant's RBC transfusion?</h3>
                <div class="radio">
                    <label><input type="radio" name="rbc_qn" value="yes" data-hide-target="#order-info-text,#info-text-2"/> Yes</label>
                </div>
                <div class="radio">
                    <label><input type="radio" name="rbc_qn" value="no" data-show-target="#order-info-text,#info-text-2,#continue"/> No</label>
                </div>
            </div>
            <div id="bd-qn" style="display: none">
                <h3>Has your child had their blood drawn within the past 8 weeks?</h3>
                <div class="radio">
                    <label><input type="radio" name="bd" value="yes" data-show-target="#syncope-qn"/> Yes</label>
                </div>
                <div class="radio">
                    <label><input type="radio" name="bd" value="no" data-hide-target="#syncope-qn"/> No</label>
                </div>
            </div>
            <div style="display:none;" id="syncope-qn">
                <h3>Has your child had any problems with a blood draw, like becoming pale or other bad reactions?/h3>
                <div class="radio">
                    <label><input type="radio" name="syncope" value="yes" data-show-target="syncope-sub-qn"/> Yes</label>
                </div>
                <div class="radio">
                    <label><input type="radio" name="syncope" value="no"/> No</label>
                </div>
                <div style="display:none;" id="syncope-sub-qn">
                    <h3>Does the amount of blood drawn during the participantâ€™s previous draw AND the amount of blood to be drawn for AoU exceed the lesser of 50 ml or 3ml per kg in an 8 week period? </h3>
                    <div class="radio">
                        <label><input type="radio" name="syncope_sub" value="yes"/> Yes</label>
                    </div>
                    <div class="radio">
                        <label><input type="radio" name="syncope_sub" value="no"/> No</label>
                    </div>
                    <div class="radio">
                        <label><input type="radio" name="syncope_sub" value="no"/> Unsure</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="alert alert-danger" style="display:none;" id="order-info-text">
            <span id="info-text-1" style="display: none">
                <strong>Important:</strong> If you have had a blood transfusion in the past 6 months, you are not eligible to donate blood or saliva for the Biobank.<br>
            </span>
            <span id="info-text-2" style="display: none">
                Participants may not have blood drawn if they have received RBC transfusion in the past 2 months. If the participant can provide adult samples, saliva and urine collection is permissible and can be initiated by selecting Continue.<br>
            </span>
            <span id="info-text-3" style="display: none">
                Caution! In order to minimize risk to participants, those who experience syncope should be offered saliva and urine collections as an alternative. Please select whether the participant would like to continue with a full Biobank order or a modified order with urine only and a saliva order.
            </span>
        </div>
        <div id="continue" style="display:none;">
            <br/>
            <p>
                <button type="submit" class="btn btn-primary">Continue</button>
            </p>
        </div>
        <input type="hidden" name="show-blood-tubes" value="no"/>
        <input type="hidden" name="show-saliva-tubes" value="no"/>
        <input type="hidden" name="csrf_token" value="{{ csrf_token('orderCheck') }}"/>
    </form>
{% endblock %}

{% block pagejs %}
    {{ encore_entry_script_tags('order-check-pediatric') }}
{% endblock %}
